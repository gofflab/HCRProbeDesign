{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"HCRProbeDesign \u00b6 HCRProbeDesign is a command-line and Python package for designing HCR v3.0 split-initiator probe pairs from a target FASTA sequence. It tiles target sequences, filters by GC content, melting temperature, homopolymers, and hairpins, and can optionally enforce genome uniqueness with Bowtie2. Documentation URL: https://www.gofflab.org/HCRProbeDesign/ Key tools \u00b6 designProbes : primary probe design CLI for single-record FASTA inputs designProbesBatch : batch probe design for multi-record FASTA inputs fetchMouseIndex : download, install, and register the mm10 Bowtie2 index buildGenomeIndex : build and register a new reference genome index Documentation layout \u00b6 Installation and prerequisites Usage walkthroughs and recommended workflows CLI reference with common flags Configuration details for HCRconfig.yaml API reference generated from inline docstrings","title":"Home"},{"location":"#hcrprobedesign","text":"HCRProbeDesign is a command-line and Python package for designing HCR v3.0 split-initiator probe pairs from a target FASTA sequence. It tiles target sequences, filters by GC content, melting temperature, homopolymers, and hairpins, and can optionally enforce genome uniqueness with Bowtie2. Documentation URL: https://www.gofflab.org/HCRProbeDesign/","title":"HCRProbeDesign"},{"location":"#key-tools","text":"designProbes : primary probe design CLI for single-record FASTA inputs designProbesBatch : batch probe design for multi-record FASTA inputs fetchMouseIndex : download, install, and register the mm10 Bowtie2 index buildGenomeIndex : build and register a new reference genome index","title":"Key tools"},{"location":"#documentation-layout","text":"Installation and prerequisites Usage walkthroughs and recommended workflows CLI reference with common flags Configuration details for HCRconfig.yaml API reference generated from inline docstrings","title":"Documentation layout"},{"location":"api/","text":"API Reference \u00b6 HCRProbeDesign.probeDesign \u00b6 Core probe design workflow and CLI entry points. build_parser() \u00b6 Build the argument parser for probe design CLIs. Returns: \u2013 argparse.ArgumentParser instance. calcOligoCost(tiles, pricePerBase=0.19) \u00b6 Calculate the cost of the oligo library Parameters: tiles \u2013 a list of Tile objects pricePerBase \u2013 the cost of a base of probe Returns: \u2013 A list of oligos. main() \u00b6 Main function for HCR Probe design. Called when used directly from cmdline main_batch() \u00b6 Batch probe design for multi-record FASTA inputs. outputIDT(tiles, outHandle=sys.stdout) \u00b6 Formats tile output for direct ordering using IDT template outputRunParams(args) \u00b6 Print run parameters to stderr. Parameters: args \u2013 Parsed argparse namespace. Returns: \u2013 None. outputTable(tiles, outHandle=sys.stdout) \u00b6 Formats tile output and writes to outHandle scanSequence(sequence, seqName, tileStep=1, tileSize=52) \u00b6 Given a sequence, a name for the sequence, a step size, and a tile size, scanSequence will return a list of Tile objects that tile across the sequence Parameters: sequence \u2013 the sequence to be tiled seqName \u2013 the name of the sequence tileStep \u2013 The step size to take between tiles, defaults to 1 (optional) tileSize \u2013 The size of the tile, defaults to 52 (optional) Returns: \u2013 A list of Tile objects test() \u00b6 Manual test harness with hard-coded parameters and FASTA file. Returns: \u2013 None. HCRProbeDesign.tiles \u00b6 Tile and probe representation used in the design pipeline. Tile(sequence, seqName, startPos) \u00b6 Represents a candidate probe tile extracted from a target sequence. Initialize a Tile from a sequence and positional metadata. Parameters: sequence \u2013 Tile sequence (string). seqName \u2013 Source sequence name. startPos \u2013 1-based start position in the source sequence. GC() \u00b6 Return GC percentage for the tile sequence. RajTm() \u00b6 Return the SantaLucia-style melting temperature estimate. Tm() \u00b6 Return the basic melting temperature estimate for the tile. __cmp__(other) \u00b6 Legacy comparison for sorting tiles by name and position. __eq__(other) \u00b6 Compare tiles by their sequences. __hash__() \u00b6 Hash tiles by their sequence. __iter__() \u00b6 Iterate over the tile sequence bases. __len__() \u00b6 Return the length of the tile sequence. __repr__() \u00b6 Return a debug-friendly representation of the tile. __str__() \u00b6 Return a human-readable representation of the tile. calcGibbs() \u00b6 Calculate the Gibbs free energy of binding for a given sequence calcdTm() \u00b6 Calculate the difference in melting temperature between the 5' and 3' sequences distance(b, enforceStrand=False) \u00b6 Returns absolute distance between self and another interval start positions. hasRuns(runChar, runLength, mismatches) \u00b6 Given a sequence, a run character, a run length, and a number of mismatches, returns True if the sequence has a run of the specified character of the specified length, with the specified number of mismatches Parameters: runChar \u2013 the character that indicates a run runLength \u2013 the length of the run of the same character mismatches \u2013 the number of mismatches allowed in the run Returns: \u2013 A boolean value. isMasked() \u00b6 Return True if the tile contains masked bases. makeProbes(channel) \u00b6 This function creates the probes for the channel. Parameters: channel \u2013 the channel that the probe is on overlaps(b) \u00b6 Return true if b overlaps self splitProbe() \u00b6 Split sequence in half with two bases in the middle removed (flexible gap to help initiator sequence land) ie. a 52mer will be split into two 25mers with the middle two bases of the 52mer dropped toBed() \u00b6 Placeholder for BED formatting support. toFasta() \u00b6 Return the tile formatted as a FASTA record. validate() \u00b6 Run lightweight validation checks on the tile. TileError(value) \u00b6 Bases: Exception Custom exception type for tile validation and processing. HCRProbeDesign.genomeMask \u00b6 Genome masking utilities based on Bowtie2 alignments. countHitsFromSam(samFile) \u00b6 For each read in the sam file, add 1 to the count of hits for that read Parameters: samFile \u2013 the name of the sam file Returns: \u2013 A dictionary with the read name as the key and the number of hits as the value. genomemask(fasta_string, handleName='tmp', species='mouse', nAlignments=3, index=None) \u00b6 Run Bowtie2 to align probe tiles and write a SAM file to disk. Parameters: fasta_string \u2013 FASTA formatted string with probe sequences. handleName \u2013 Prefix for FASTA/SAM output files. species \u2013 Species key in HCRconfig.yaml. nAlignments \u2013 Number of alignments to report per read. index \u2013 Optional Bowtie2 index prefix override. Returns: \u2013 Bowtie2 subprocess return code. install_index(url='https://genome-idx.s3.amazonaws.com/bt/mm10.zip', genome='mm10', species='mouse') \u00b6 Download and extract a prebuilt Bowtie2 index into the package indices. Parameters: url \u2013 URL to a zipped Bowtie2 index archive. genome \u2013 Genome name used to name the extraction directory. Returns: \u2013 None. test() \u00b6 Quick manual test for Bowtie2 masking and SAM parsing. HCRProbeDesign.referenceGenome \u00b6 Build and register Bowtie2 indices for reference genomes. build_bowtie2_index(fasta_paths, species, index_name=None, indices_dir=None, threads=1, force=False) \u00b6 Build a Bowtie2 index from the provided FASTA files. Parameters: fasta_paths \u2013 List of FASTA file paths. species \u2013 Species name for the index directory. index_name \u2013 Optional index basename override. indices_dir \u2013 Output directory for indices. threads \u2013 Number of threads for bowtie2-build. force \u2013 Overwrite existing index files if True. Returns: \u2013 Index prefix path. Raises: RuntimeError \u2013 If bowtie2-build is not available. FileExistsError \u2013 If index exists and force is False. collect_fasta_inputs(paths) \u00b6 Resolve FASTA inputs from files and directories. Parameters: paths \u2013 List of FASTA files or directories. Returns: \u2013 Deduplicated list of FASTA file paths. Raises: FileNotFoundError \u2013 If a path or directory has no FASTA files. format_index_path(index_prefix) \u00b6 Format an index prefix relative to the package when possible. Parameters: index_prefix \u2013 Bowtie2 index prefix path. Returns: \u2013 Relative path if within package, otherwise absolute path. load_config(config_path=DEFAULT_CONFIG_PATH) \u00b6 Load the HCRconfig.yaml file. Parameters: config_path \u2013 Path to the YAML configuration file. Returns: \u2013 Parsed config dictionary (empty if missing). main() \u00b6 CLI entry point for building and registering a reference genome index. register_species(config_path, species, index_prefix, force=False) \u00b6 Register a species and its Bowtie2 index prefix in the config file. Parameters: config_path \u2013 Path to HCRconfig.yaml. species \u2013 Species key to register. index_prefix \u2013 Bowtie2 index prefix path. force \u2013 Overwrite an existing species entry if True. Returns: \u2013 None. Raises: ValueError \u2013 If the species exists and force is False. save_config(config, config_path=DEFAULT_CONFIG_PATH) \u00b6 Write configuration data to HCRconfig.yaml. Parameters: config \u2013 Configuration dictionary. config_path \u2013 Path to write the configuration. Returns: \u2013 None. HCRProbeDesign.sequencelib \u00b6 Sequence parsing and utility functions. FastaIterator(handle) \u00b6 Generator function to iterate over fasta records in : Use in a loop to apply to each Seq record contained in a .fasta file Input: record handle as obtained by handle = open( ,'r') Returns an iterator across Sequences in file GenRandomSeq(length, type='DNA') \u00b6 Generate a random sequence of DNA or RNA of a given length Parameters: length \u2013 the length of the random sequence type \u2013 DNA or RNA, defaults to DNA (optional) Returns: \u2013 A string of length length consisting of random characters from chars. allindices(string, sub, listindex=[], offset=0) \u00b6 Return a list of all indices of a substring in a string Parameters: string \u2013 the string to be searched sub \u2013 The string you're looking for listindex \u2013 an empty list offset \u2013 the index in the string where you want to start searching, defaults to 0 (optional) Returns: \u2013 A list of all the indices where the substring sub is found in string. complement(s) \u00b6 Return the complement of a DNA sequence Parameters: s \u2013 sequence Returns: \u2013 A list of the complement bases of the sequence. draw(distribution) \u00b6 Draw a random value from the distribution, where values with a higher probability are drawn more often Parameters: distribution \u2013 a list of positive numbers that sum to 1 Returns: \u2013 The index of the array that the random number falls into. find_all(seq, sub) \u00b6 Find all occurences of a substring in a string Parameters: seq \u2013 the string to be searched sub \u2013 The substring to search for Returns: \u2013 A list of all the positions where the substring was found. gc_content(seq) \u00b6 Given a DNA sequence, return the percentage of G's and C's in the sequence Parameters: seq \u2013 the sequence to be analyzed Returns: \u2013 The GC content of the sequence. genRandomFromDist(length, freqs) \u00b6 Generates a random sequence of length 'length' drawing from a distribution of base frequencies in a dictionary getGC(seq) \u00b6 The function getGC(seq) takes a string of DNA sequence as input and returns the GC content of the sequence Parameters: seq \u2013 the sequence to be analyzed Returns: \u2013 A list of tuples. Each tuple contains the name of the gene, the GC content, and the length of the gene. getTm(seq) \u00b6 The function getTm(seq) takes a sequence as an argument and returns the melting temperature of the sequence Parameters: seq \u2013 the sequence of interest Returns: \u2013 The melting temperature of the sequence. get_seeds(iter, seeds={}) \u00b6 Given a list of sequences, return a dictionary of the counts of each seed Parameters: iter \u2013 the iterator of sequences seeds \u2013 a dictionary of seeds and their counts Returns: \u2013 A dictionary with the seeds as keys and the number of times they occur as values. kmer_dictionary(seq, k, dic={}, offset=0) \u00b6 Returns dictionary of k,v = kmer:'list of kmer start positions in seq' kmer_dictionary_counts(seq, k, dic={}) \u00b6 Returns a dictionary of k,v = kmer:'count of kmer in seq' kmer_stats(kmer, dic, genfreqs) \u00b6 Takes as argument a kmer string, a dictionary with kmers as keys from kmer_dictionary_counts, and a dictionary of genomic frequencies with kmers as keys. Returns a dictionary of stats for kmer (\"Signal2Noise Ratio, Z-score\") makeDistFromFreqs(freqs) \u00b6 Given a dictionary of character frequencies, return a list of cumulative frequencies Parameters: freqs \u2013 a dictionary of the frequencies of each nucleotide at each position Returns: \u2013 a list of cumulative frequencies. mcount(s, chars) \u00b6 Sums the counts of appearances of each char in chars Parameters: s \u2013 the string to search chars \u2013 a string of characters to count Returns: \u2013 The number of times the characters in chars appear in s. prob_seq(seq, pGC=0.5) \u00b6 Given a sequence and a background GC probability, what is the probability of getting that sequence Parameters: seq \u2013 the sequence of interest pGC \u2013 the probability of a GC base pair Returns: \u2013 The probability of the sequence given the background GC probability. rcomp(s) \u00b6 Does same thing as reverse_complement only cooler reverse_complement(s) \u00b6 Return the reverse complement of a DNA sequence Parameters: s \u2013 The sequence to be reverse complemented Returns: \u2013 The reverse complement of the input sequence. seed() \u00b6 Seed the random number generator with system entropy. transcribe(seq) \u00b6 The function transcribe() takes a DNA sequence and replaces each instance of the nucleotide T with a uracil (U) in the transcribed RNA sequence Parameters: seq \u2013 the sequence to be transcribed Returns: \u2013 The transcribed RNA sequence. HCRProbeDesign.thermo \u00b6 @authors: Marshall J. Levesque Arjun Raj Daniel Wei Tm(sequence) \u00b6 The function calculates the melting temperature of a sequence Parameters: sequence \u2013 the sequence of the primer Returns: \u2013 The melting temperature of the primer. Tm_RNA_DNA(sequence) \u00b6 Given a sequence, the function returns the Tm of the sequence using the SantaLucia 98 parameters Parameters: sequence \u2013 the sequence of the primer Returns: \u2013 The dG value. containsAny(astring, aset) \u00b6 Check whether a string contains any of the given characters. Parameters: astring \u2013 Input string. aset \u2013 Iterable of characters to search for. Returns: \u2013 True if any character is present. gibbs(dH, dS, temp=37) \u00b6 Calc Gibbs Free Energy in cal/mol from enthaply, entropy, and temperature Arguments: dH -- enthalpy in kcal/mol dS -- entropy in cal/(mol * Kelvin) temp -- temperature in celcius (default 37 degrees C) init_dna_dna(inseq) \u00b6 Return [enthalpy, entropy] list with units kcal/mol and cal/(mol*Kelvin) for DNA/DNA duplex initiation for the input DNA sequence (actg 5'->3'). Values from SantaLucia 1998. Argument is DNA init_rna_dna() \u00b6 Return [enthalpy, entropy] list in kcal/mol and cal/(mol*Kelvin) for RNA/DNA duplex initiation. Values from Sugimoto et al 1995 melting_temp(dH, dS, ca, cb, salt) \u00b6 Calculates the melting temperature of a DNA sequence. Parameters: dH \u2013 Enthalpy (delta H). This is the energy required to separate the strands of the DNA duplex in kilo Joules per mole dS \u2013 Entropy of hybridization (cal/(K*mol)) ca \u2013 concentration of a strand in nM cb \u2013 concentration of the complementary strand (M) salt \u2013 the molarity of the Na+ in the hybridisation reaction Returns: \u2013 The melting temperature of the primer. overhang_dna(inseq, end) \u00b6 Return Gibbs free energy at 37degC (in kcal/mol) contribution from single base overhang in DNA/DNA duplex. Arguments: inseq - 2bp DNA sequence (5' -> 3') end - specifies which end the over hang is on (valid values: 3 or 5) Table 2 in Bommarito, S. (2000). Nucleic Acids Research overhang_rna(inseq, end) \u00b6 Return Gibbs free energy at 37degC (in kcal/mol) contribution from single base overhang in RNA/RNA duplex. Arguments: inseq - 2bp RNA sequence (5' -> 3') uracil->thymidine end - specifies which end the over hang is on (valid values: 3 or 5) Table 3 in Freier et al, Biochemistry, 1986 salt_adjust(delG, nbases, saltconc) \u00b6 Adjust Gibbs Free Energy from 1M Na+ for another concentration Arguments: delG -- Gibbs free energy in kcal/mol nbases -- number of bases in the sequence saltconc -- desired Na+ concentration for new Gibbs free energy calculation Equation 7 SantaLucia 1998 stacks_dna_dna(inseq, temp=37) \u00b6 Calculate thermodynamic values for DNA/DNA hybridization. Input Arguments: inseq -- the input DNA sequence of the DNA/DNA hybrid (5'->3') temp -- in celcius for Gibbs free energy calc (default 37degC) salt -- salt concentration in units of mol/L (default 0.33M) Return [enthalpy, entropy] list in kcal/mol and cal/(mol*Kelvin) stacks_rna_dna(inseq) \u00b6 Calculate RNA/DNA base stack thermodynamic values (Sugimoto et al 1995) Sugimoto 95 parameters for RNA/DNA Hybridization (Table 3) \"Thermodynamic Parameters To Predict Stability of RNA/DNA Hybrid Duplexes\" in Biochemistry 1995 Input Arguments: inseq -- RNA sequence of the RNA/DNA hybrid ( 5'->3' uracil->thymidine) Return [enthalpy, entropy] list in kcal/mol and cal/(mol*Kelvin) HCRProbeDesign.utils \u00b6 Miscellaneous utilities for sequence processing and formatting. FastaIterator(handle) \u00b6 Generator function to iterate over fasta records in : Use in a loop to apply to each sequence record contained in a .fasta file Input: record handle as obtained by handle = open( ,'r') Returns an iterator across sequences in file buildTags(numTags, tagLength, sites=None) \u00b6 Generate random DNA tags with optional restriction site filtering. Parameters: numTags \u2013 Number of tags to generate. tagLength \u2013 Length of each tag. sites \u2013 Comma-delimited restriction sites to avoid. Returns: \u2013 List of DNA tag strings. eprint(*args, **kwargs) \u00b6 Print to stderr with the same signature as print(). Returns: \u2013 None. estimateAffixLength(sequence, tagLength) \u00b6 Estimate sequence length after tag insertion. Parameters: sequence \u2013 Sequence containing an optional '@' tag marker. tagLength \u2013 Length of the tag to be inserted. Returns: \u2013 Adjusted sequence length. Raises: TileError \u2013 If multiple tag markers are present. findUnique(tiles) \u00b6 Return a list of unique Tile objects from the input list. hasRestrictionSites(sequence, sites) \u00b6 Check if a sequence contains restriction sites. Parameters: sequence \u2013 Sequence to scan. sites \u2013 Comma-delimited restriction site names. Returns: \u2013 True if any sites are present. onlyNucleic(seq, set=['a', 'c', 'g', 't', 'u', 'A', 'C', 'G', 'T', 'U', 'n', 'N', '@']) \u00b6 Check whether a sequence contains only nucleic characters. Parameters: seq \u2013 Input sequence string. set \u2013 Allowed characters. Returns: \u2013 True if all characters are allowed. pp(d, level=-1, maxw=0, maxh=0, parsable=0) \u00b6 wrapper around pretty_print that prints to stdout pretty_print(f, d, level=-1, maxw=0, maxh=0, gap='', first_gap='', last_gap='') \u00b6 Pretty-print nested structures to a file handle. Parameters: f \u2013 Output file-like object. d \u2013 Data structure to render. level \u2013 Recursion depth (-1 for unlimited). maxw \u2013 Maximum width per line. maxh \u2013 Maximum items per list/dict/tuple. gap \u2013 Base indentation string. first_gap \u2013 Indentation for opening delimiter line. last_gap \u2013 Indentation for closing delimiter line. Returns: \u2013 None. warnRestrictionSites(sequence, name, sites) \u00b6 Print a warning if restriction sites are found in a sequence. Parameters: sequence \u2013 Sequence to scan. name \u2013 Sequence label for logging. sites \u2013 Comma-delimited restriction site names. Returns: \u2013 None. HCRProbeDesign.BLAST \u00b6 NCBI BLAST utilities for probe sequence validation. blastProbes(fasta_string, species='mouse', verbose=True) \u00b6 Submit a BLASTN job for the given FASTA string. Parameters: fasta_string \u2013 FASTA-formatted string containing probe sequences. species \u2013 Species key for Entrez restriction (mouse or human). verbose \u2013 Emit progress messages to stderr. Returns: \u2013 NCBIWWW result handle for subsequent parsing. getNHits(blast_handle, verbose=True) \u00b6 Report the number of hits for each record in a BLAST response. Parameters: blast_handle \u2013 Handle returned by NCBIWWW.qblast. verbose \u2013 Reserved for future verbosity controls. Returns: \u2013 None. HCRProbeDesign.repeatMask \u00b6 RepeatMasker web API helper utilities (deprecated). repeatmask(sequence, dnasource='mouse') \u00b6 This function takes a sequence and returns a masked sequence with help from RepeatMasker Parameters: sequence \u2013 The sequence to be masked dnasource \u2013 vertebrate, mammal, human, rodent, mouse, rat, danio, drosophila, elegans, defaults to mouse (optional) Returns: \u2013 A masked sequence. repeatmasker_local(sequence, dnasource='mouse') \u00b6 Placeholder for a local RepeatMasker wrapper. Parameters: sequence \u2013 Sequence to mask. dnasource \u2013 RepeatMasker DNA source key. Returns: \u2013 None. test() \u00b6 Simple smoke test for the remote RepeatMasker flow.","title":"API Reference"},{"location":"api/#api-reference","text":"","title":"API Reference"},{"location":"api/#hcrprobedesignprobedesign","text":"Core probe design workflow and CLI entry points.","title":"HCRProbeDesign.probeDesign"},{"location":"api/#HCRProbeDesign.probeDesign.build_parser","text":"Build the argument parser for probe design CLIs. Returns: \u2013 argparse.ArgumentParser instance.","title":"build_parser"},{"location":"api/#HCRProbeDesign.probeDesign.calcOligoCost","text":"Calculate the cost of the oligo library Parameters: tiles \u2013 a list of Tile objects pricePerBase \u2013 the cost of a base of probe Returns: \u2013 A list of oligos.","title":"calcOligoCost"},{"location":"api/#HCRProbeDesign.probeDesign.main","text":"Main function for HCR Probe design. Called when used directly from cmdline","title":"main"},{"location":"api/#HCRProbeDesign.probeDesign.main_batch","text":"Batch probe design for multi-record FASTA inputs.","title":"main_batch"},{"location":"api/#HCRProbeDesign.probeDesign.outputIDT","text":"Formats tile output for direct ordering using IDT template","title":"outputIDT"},{"location":"api/#HCRProbeDesign.probeDesign.outputRunParams","text":"Print run parameters to stderr. Parameters: args \u2013 Parsed argparse namespace. Returns: \u2013 None.","title":"outputRunParams"},{"location":"api/#HCRProbeDesign.probeDesign.outputTable","text":"Formats tile output and writes to outHandle","title":"outputTable"},{"location":"api/#HCRProbeDesign.probeDesign.scanSequence","text":"Given a sequence, a name for the sequence, a step size, and a tile size, scanSequence will return a list of Tile objects that tile across the sequence Parameters: sequence \u2013 the sequence to be tiled seqName \u2013 the name of the sequence tileStep \u2013 The step size to take between tiles, defaults to 1 (optional) tileSize \u2013 The size of the tile, defaults to 52 (optional) Returns: \u2013 A list of Tile objects","title":"scanSequence"},{"location":"api/#HCRProbeDesign.probeDesign.test","text":"Manual test harness with hard-coded parameters and FASTA file. Returns: \u2013 None.","title":"test"},{"location":"api/#hcrprobedesigntiles","text":"Tile and probe representation used in the design pipeline.","title":"HCRProbeDesign.tiles"},{"location":"api/#HCRProbeDesign.tiles.Tile","text":"Represents a candidate probe tile extracted from a target sequence. Initialize a Tile from a sequence and positional metadata. Parameters: sequence \u2013 Tile sequence (string). seqName \u2013 Source sequence name. startPos \u2013 1-based start position in the source sequence.","title":"Tile"},{"location":"api/#HCRProbeDesign.tiles.Tile.GC","text":"Return GC percentage for the tile sequence.","title":"GC"},{"location":"api/#HCRProbeDesign.tiles.Tile.RajTm","text":"Return the SantaLucia-style melting temperature estimate.","title":"RajTm"},{"location":"api/#HCRProbeDesign.tiles.Tile.Tm","text":"Return the basic melting temperature estimate for the tile.","title":"Tm"},{"location":"api/#HCRProbeDesign.tiles.Tile.__cmp__","text":"Legacy comparison for sorting tiles by name and position.","title":"__cmp__"},{"location":"api/#HCRProbeDesign.tiles.Tile.__eq__","text":"Compare tiles by their sequences.","title":"__eq__"},{"location":"api/#HCRProbeDesign.tiles.Tile.__hash__","text":"Hash tiles by their sequence.","title":"__hash__"},{"location":"api/#HCRProbeDesign.tiles.Tile.__iter__","text":"Iterate over the tile sequence bases.","title":"__iter__"},{"location":"api/#HCRProbeDesign.tiles.Tile.__len__","text":"Return the length of the tile sequence.","title":"__len__"},{"location":"api/#HCRProbeDesign.tiles.Tile.__repr__","text":"Return a debug-friendly representation of the tile.","title":"__repr__"},{"location":"api/#HCRProbeDesign.tiles.Tile.__str__","text":"Return a human-readable representation of the tile.","title":"__str__"},{"location":"api/#HCRProbeDesign.tiles.Tile.calcGibbs","text":"Calculate the Gibbs free energy of binding for a given sequence","title":"calcGibbs"},{"location":"api/#HCRProbeDesign.tiles.Tile.calcdTm","text":"Calculate the difference in melting temperature between the 5' and 3' sequences","title":"calcdTm"},{"location":"api/#HCRProbeDesign.tiles.Tile.distance","text":"Returns absolute distance between self and another interval start positions.","title":"distance"},{"location":"api/#HCRProbeDesign.tiles.Tile.hasRuns","text":"Given a sequence, a run character, a run length, and a number of mismatches, returns True if the sequence has a run of the specified character of the specified length, with the specified number of mismatches Parameters: runChar \u2013 the character that indicates a run runLength \u2013 the length of the run of the same character mismatches \u2013 the number of mismatches allowed in the run Returns: \u2013 A boolean value.","title":"hasRuns"},{"location":"api/#HCRProbeDesign.tiles.Tile.isMasked","text":"Return True if the tile contains masked bases.","title":"isMasked"},{"location":"api/#HCRProbeDesign.tiles.Tile.makeProbes","text":"This function creates the probes for the channel. Parameters: channel \u2013 the channel that the probe is on","title":"makeProbes"},{"location":"api/#HCRProbeDesign.tiles.Tile.overlaps","text":"Return true if b overlaps self","title":"overlaps"},{"location":"api/#HCRProbeDesign.tiles.Tile.splitProbe","text":"Split sequence in half with two bases in the middle removed (flexible gap to help initiator sequence land) ie. a 52mer will be split into two 25mers with the middle two bases of the 52mer dropped","title":"splitProbe"},{"location":"api/#HCRProbeDesign.tiles.Tile.toBed","text":"Placeholder for BED formatting support.","title":"toBed"},{"location":"api/#HCRProbeDesign.tiles.Tile.toFasta","text":"Return the tile formatted as a FASTA record.","title":"toFasta"},{"location":"api/#HCRProbeDesign.tiles.Tile.validate","text":"Run lightweight validation checks on the tile.","title":"validate"},{"location":"api/#HCRProbeDesign.tiles.TileError","text":"Bases: Exception Custom exception type for tile validation and processing.","title":"TileError"},{"location":"api/#hcrprobedesigngenomemask","text":"Genome masking utilities based on Bowtie2 alignments.","title":"HCRProbeDesign.genomeMask"},{"location":"api/#HCRProbeDesign.genomeMask.countHitsFromSam","text":"For each read in the sam file, add 1 to the count of hits for that read Parameters: samFile \u2013 the name of the sam file Returns: \u2013 A dictionary with the read name as the key and the number of hits as the value.","title":"countHitsFromSam"},{"location":"api/#HCRProbeDesign.genomeMask.genomemask","text":"Run Bowtie2 to align probe tiles and write a SAM file to disk. Parameters: fasta_string \u2013 FASTA formatted string with probe sequences. handleName \u2013 Prefix for FASTA/SAM output files. species \u2013 Species key in HCRconfig.yaml. nAlignments \u2013 Number of alignments to report per read. index \u2013 Optional Bowtie2 index prefix override. Returns: \u2013 Bowtie2 subprocess return code.","title":"genomemask"},{"location":"api/#HCRProbeDesign.genomeMask.install_index","text":"Download and extract a prebuilt Bowtie2 index into the package indices. Parameters: url \u2013 URL to a zipped Bowtie2 index archive. genome \u2013 Genome name used to name the extraction directory. Returns: \u2013 None.","title":"install_index"},{"location":"api/#HCRProbeDesign.genomeMask.test","text":"Quick manual test for Bowtie2 masking and SAM parsing.","title":"test"},{"location":"api/#hcrprobedesignreferencegenome","text":"Build and register Bowtie2 indices for reference genomes.","title":"HCRProbeDesign.referenceGenome"},{"location":"api/#HCRProbeDesign.referenceGenome.build_bowtie2_index","text":"Build a Bowtie2 index from the provided FASTA files. Parameters: fasta_paths \u2013 List of FASTA file paths. species \u2013 Species name for the index directory. index_name \u2013 Optional index basename override. indices_dir \u2013 Output directory for indices. threads \u2013 Number of threads for bowtie2-build. force \u2013 Overwrite existing index files if True. Returns: \u2013 Index prefix path. Raises: RuntimeError \u2013 If bowtie2-build is not available. FileExistsError \u2013 If index exists and force is False.","title":"build_bowtie2_index"},{"location":"api/#HCRProbeDesign.referenceGenome.collect_fasta_inputs","text":"Resolve FASTA inputs from files and directories. Parameters: paths \u2013 List of FASTA files or directories. Returns: \u2013 Deduplicated list of FASTA file paths. Raises: FileNotFoundError \u2013 If a path or directory has no FASTA files.","title":"collect_fasta_inputs"},{"location":"api/#HCRProbeDesign.referenceGenome.format_index_path","text":"Format an index prefix relative to the package when possible. Parameters: index_prefix \u2013 Bowtie2 index prefix path. Returns: \u2013 Relative path if within package, otherwise absolute path.","title":"format_index_path"},{"location":"api/#HCRProbeDesign.referenceGenome.load_config","text":"Load the HCRconfig.yaml file. Parameters: config_path \u2013 Path to the YAML configuration file. Returns: \u2013 Parsed config dictionary (empty if missing).","title":"load_config"},{"location":"api/#HCRProbeDesign.referenceGenome.main","text":"CLI entry point for building and registering a reference genome index.","title":"main"},{"location":"api/#HCRProbeDesign.referenceGenome.register_species","text":"Register a species and its Bowtie2 index prefix in the config file. Parameters: config_path \u2013 Path to HCRconfig.yaml. species \u2013 Species key to register. index_prefix \u2013 Bowtie2 index prefix path. force \u2013 Overwrite an existing species entry if True. Returns: \u2013 None. Raises: ValueError \u2013 If the species exists and force is False.","title":"register_species"},{"location":"api/#HCRProbeDesign.referenceGenome.save_config","text":"Write configuration data to HCRconfig.yaml. Parameters: config \u2013 Configuration dictionary. config_path \u2013 Path to write the configuration. Returns: \u2013 None.","title":"save_config"},{"location":"api/#hcrprobedesignsequencelib","text":"Sequence parsing and utility functions.","title":"HCRProbeDesign.sequencelib"},{"location":"api/#HCRProbeDesign.sequencelib.FastaIterator","text":"Generator function to iterate over fasta records in : Use in a loop to apply to each Seq record contained in a .fasta file Input: record handle as obtained by handle = open( ,'r') Returns an iterator across Sequences in file","title":"FastaIterator"},{"location":"api/#HCRProbeDesign.sequencelib.GenRandomSeq","text":"Generate a random sequence of DNA or RNA of a given length Parameters: length \u2013 the length of the random sequence type \u2013 DNA or RNA, defaults to DNA (optional) Returns: \u2013 A string of length length consisting of random characters from chars.","title":"GenRandomSeq"},{"location":"api/#HCRProbeDesign.sequencelib.allindices","text":"Return a list of all indices of a substring in a string Parameters: string \u2013 the string to be searched sub \u2013 The string you're looking for listindex \u2013 an empty list offset \u2013 the index in the string where you want to start searching, defaults to 0 (optional) Returns: \u2013 A list of all the indices where the substring sub is found in string.","title":"allindices"},{"location":"api/#HCRProbeDesign.sequencelib.complement","text":"Return the complement of a DNA sequence Parameters: s \u2013 sequence Returns: \u2013 A list of the complement bases of the sequence.","title":"complement"},{"location":"api/#HCRProbeDesign.sequencelib.draw","text":"Draw a random value from the distribution, where values with a higher probability are drawn more often Parameters: distribution \u2013 a list of positive numbers that sum to 1 Returns: \u2013 The index of the array that the random number falls into.","title":"draw"},{"location":"api/#HCRProbeDesign.sequencelib.find_all","text":"Find all occurences of a substring in a string Parameters: seq \u2013 the string to be searched sub \u2013 The substring to search for Returns: \u2013 A list of all the positions where the substring was found.","title":"find_all"},{"location":"api/#HCRProbeDesign.sequencelib.gc_content","text":"Given a DNA sequence, return the percentage of G's and C's in the sequence Parameters: seq \u2013 the sequence to be analyzed Returns: \u2013 The GC content of the sequence.","title":"gc_content"},{"location":"api/#HCRProbeDesign.sequencelib.genRandomFromDist","text":"Generates a random sequence of length 'length' drawing from a distribution of base frequencies in a dictionary","title":"genRandomFromDist"},{"location":"api/#HCRProbeDesign.sequencelib.getGC","text":"The function getGC(seq) takes a string of DNA sequence as input and returns the GC content of the sequence Parameters: seq \u2013 the sequence to be analyzed Returns: \u2013 A list of tuples. Each tuple contains the name of the gene, the GC content, and the length of the gene.","title":"getGC"},{"location":"api/#HCRProbeDesign.sequencelib.getTm","text":"The function getTm(seq) takes a sequence as an argument and returns the melting temperature of the sequence Parameters: seq \u2013 the sequence of interest Returns: \u2013 The melting temperature of the sequence.","title":"getTm"},{"location":"api/#HCRProbeDesign.sequencelib.get_seeds","text":"Given a list of sequences, return a dictionary of the counts of each seed Parameters: iter \u2013 the iterator of sequences seeds \u2013 a dictionary of seeds and their counts Returns: \u2013 A dictionary with the seeds as keys and the number of times they occur as values.","title":"get_seeds"},{"location":"api/#HCRProbeDesign.sequencelib.kmer_dictionary","text":"Returns dictionary of k,v = kmer:'list of kmer start positions in seq'","title":"kmer_dictionary"},{"location":"api/#HCRProbeDesign.sequencelib.kmer_dictionary_counts","text":"Returns a dictionary of k,v = kmer:'count of kmer in seq'","title":"kmer_dictionary_counts"},{"location":"api/#HCRProbeDesign.sequencelib.kmer_stats","text":"Takes as argument a kmer string, a dictionary with kmers as keys from kmer_dictionary_counts, and a dictionary of genomic frequencies with kmers as keys. Returns a dictionary of stats for kmer (\"Signal2Noise Ratio, Z-score\")","title":"kmer_stats"},{"location":"api/#HCRProbeDesign.sequencelib.makeDistFromFreqs","text":"Given a dictionary of character frequencies, return a list of cumulative frequencies Parameters: freqs \u2013 a dictionary of the frequencies of each nucleotide at each position Returns: \u2013 a list of cumulative frequencies.","title":"makeDistFromFreqs"},{"location":"api/#HCRProbeDesign.sequencelib.mcount","text":"Sums the counts of appearances of each char in chars Parameters: s \u2013 the string to search chars \u2013 a string of characters to count Returns: \u2013 The number of times the characters in chars appear in s.","title":"mcount"},{"location":"api/#HCRProbeDesign.sequencelib.prob_seq","text":"Given a sequence and a background GC probability, what is the probability of getting that sequence Parameters: seq \u2013 the sequence of interest pGC \u2013 the probability of a GC base pair Returns: \u2013 The probability of the sequence given the background GC probability.","title":"prob_seq"},{"location":"api/#HCRProbeDesign.sequencelib.rcomp","text":"Does same thing as reverse_complement only cooler","title":"rcomp"},{"location":"api/#HCRProbeDesign.sequencelib.reverse_complement","text":"Return the reverse complement of a DNA sequence Parameters: s \u2013 The sequence to be reverse complemented Returns: \u2013 The reverse complement of the input sequence.","title":"reverse_complement"},{"location":"api/#HCRProbeDesign.sequencelib.seed","text":"Seed the random number generator with system entropy.","title":"seed"},{"location":"api/#HCRProbeDesign.sequencelib.transcribe","text":"The function transcribe() takes a DNA sequence and replaces each instance of the nucleotide T with a uracil (U) in the transcribed RNA sequence Parameters: seq \u2013 the sequence to be transcribed Returns: \u2013 The transcribed RNA sequence.","title":"transcribe"},{"location":"api/#hcrprobedesignthermo","text":"@authors: Marshall J. Levesque Arjun Raj Daniel Wei","title":"HCRProbeDesign.thermo"},{"location":"api/#HCRProbeDesign.thermo.Tm","text":"The function calculates the melting temperature of a sequence Parameters: sequence \u2013 the sequence of the primer Returns: \u2013 The melting temperature of the primer.","title":"Tm"},{"location":"api/#HCRProbeDesign.thermo.Tm_RNA_DNA","text":"Given a sequence, the function returns the Tm of the sequence using the SantaLucia 98 parameters Parameters: sequence \u2013 the sequence of the primer Returns: \u2013 The dG value.","title":"Tm_RNA_DNA"},{"location":"api/#HCRProbeDesign.thermo.containsAny","text":"Check whether a string contains any of the given characters. Parameters: astring \u2013 Input string. aset \u2013 Iterable of characters to search for. Returns: \u2013 True if any character is present.","title":"containsAny"},{"location":"api/#HCRProbeDesign.thermo.gibbs","text":"Calc Gibbs Free Energy in cal/mol from enthaply, entropy, and temperature Arguments: dH -- enthalpy in kcal/mol dS -- entropy in cal/(mol * Kelvin) temp -- temperature in celcius (default 37 degrees C)","title":"gibbs"},{"location":"api/#HCRProbeDesign.thermo.init_dna_dna","text":"Return [enthalpy, entropy] list with units kcal/mol and cal/(mol*Kelvin) for DNA/DNA duplex initiation for the input DNA sequence (actg 5'->3'). Values from SantaLucia 1998. Argument is DNA","title":"init_dna_dna"},{"location":"api/#HCRProbeDesign.thermo.init_rna_dna","text":"Return [enthalpy, entropy] list in kcal/mol and cal/(mol*Kelvin) for RNA/DNA duplex initiation. Values from Sugimoto et al 1995","title":"init_rna_dna"},{"location":"api/#HCRProbeDesign.thermo.melting_temp","text":"Calculates the melting temperature of a DNA sequence. Parameters: dH \u2013 Enthalpy (delta H). This is the energy required to separate the strands of the DNA duplex in kilo Joules per mole dS \u2013 Entropy of hybridization (cal/(K*mol)) ca \u2013 concentration of a strand in nM cb \u2013 concentration of the complementary strand (M) salt \u2013 the molarity of the Na+ in the hybridisation reaction Returns: \u2013 The melting temperature of the primer.","title":"melting_temp"},{"location":"api/#HCRProbeDesign.thermo.overhang_dna","text":"Return Gibbs free energy at 37degC (in kcal/mol) contribution from single base overhang in DNA/DNA duplex. Arguments: inseq - 2bp DNA sequence (5' -> 3') end - specifies which end the over hang is on (valid values: 3 or 5) Table 2 in Bommarito, S. (2000). Nucleic Acids Research","title":"overhang_dna"},{"location":"api/#HCRProbeDesign.thermo.overhang_rna","text":"Return Gibbs free energy at 37degC (in kcal/mol) contribution from single base overhang in RNA/RNA duplex. Arguments: inseq - 2bp RNA sequence (5' -> 3') uracil->thymidine end - specifies which end the over hang is on (valid values: 3 or 5) Table 3 in Freier et al, Biochemistry, 1986","title":"overhang_rna"},{"location":"api/#HCRProbeDesign.thermo.salt_adjust","text":"Adjust Gibbs Free Energy from 1M Na+ for another concentration Arguments: delG -- Gibbs free energy in kcal/mol nbases -- number of bases in the sequence saltconc -- desired Na+ concentration for new Gibbs free energy calculation Equation 7 SantaLucia 1998","title":"salt_adjust"},{"location":"api/#HCRProbeDesign.thermo.stacks_dna_dna","text":"Calculate thermodynamic values for DNA/DNA hybridization. Input Arguments: inseq -- the input DNA sequence of the DNA/DNA hybrid (5'->3') temp -- in celcius for Gibbs free energy calc (default 37degC) salt -- salt concentration in units of mol/L (default 0.33M) Return [enthalpy, entropy] list in kcal/mol and cal/(mol*Kelvin)","title":"stacks_dna_dna"},{"location":"api/#HCRProbeDesign.thermo.stacks_rna_dna","text":"Calculate RNA/DNA base stack thermodynamic values (Sugimoto et al 1995) Sugimoto 95 parameters for RNA/DNA Hybridization (Table 3) \"Thermodynamic Parameters To Predict Stability of RNA/DNA Hybrid Duplexes\" in Biochemistry 1995 Input Arguments: inseq -- RNA sequence of the RNA/DNA hybrid ( 5'->3' uracil->thymidine) Return [enthalpy, entropy] list in kcal/mol and cal/(mol*Kelvin)","title":"stacks_rna_dna"},{"location":"api/#hcrprobedesignutils","text":"Miscellaneous utilities for sequence processing and formatting.","title":"HCRProbeDesign.utils"},{"location":"api/#HCRProbeDesign.utils.FastaIterator","text":"Generator function to iterate over fasta records in : Use in a loop to apply to each sequence record contained in a .fasta file Input: record handle as obtained by handle = open( ,'r') Returns an iterator across sequences in file","title":"FastaIterator"},{"location":"api/#HCRProbeDesign.utils.buildTags","text":"Generate random DNA tags with optional restriction site filtering. Parameters: numTags \u2013 Number of tags to generate. tagLength \u2013 Length of each tag. sites \u2013 Comma-delimited restriction sites to avoid. Returns: \u2013 List of DNA tag strings.","title":"buildTags"},{"location":"api/#HCRProbeDesign.utils.eprint","text":"Print to stderr with the same signature as print(). Returns: \u2013 None.","title":"eprint"},{"location":"api/#HCRProbeDesign.utils.estimateAffixLength","text":"Estimate sequence length after tag insertion. Parameters: sequence \u2013 Sequence containing an optional '@' tag marker. tagLength \u2013 Length of the tag to be inserted. Returns: \u2013 Adjusted sequence length. Raises: TileError \u2013 If multiple tag markers are present.","title":"estimateAffixLength"},{"location":"api/#HCRProbeDesign.utils.findUnique","text":"Return a list of unique Tile objects from the input list.","title":"findUnique"},{"location":"api/#HCRProbeDesign.utils.hasRestrictionSites","text":"Check if a sequence contains restriction sites. Parameters: sequence \u2013 Sequence to scan. sites \u2013 Comma-delimited restriction site names. Returns: \u2013 True if any sites are present.","title":"hasRestrictionSites"},{"location":"api/#HCRProbeDesign.utils.onlyNucleic","text":"Check whether a sequence contains only nucleic characters. Parameters: seq \u2013 Input sequence string. set \u2013 Allowed characters. Returns: \u2013 True if all characters are allowed.","title":"onlyNucleic"},{"location":"api/#HCRProbeDesign.utils.pp","text":"wrapper around pretty_print that prints to stdout","title":"pp"},{"location":"api/#HCRProbeDesign.utils.pretty_print","text":"Pretty-print nested structures to a file handle. Parameters: f \u2013 Output file-like object. d \u2013 Data structure to render. level \u2013 Recursion depth (-1 for unlimited). maxw \u2013 Maximum width per line. maxh \u2013 Maximum items per list/dict/tuple. gap \u2013 Base indentation string. first_gap \u2013 Indentation for opening delimiter line. last_gap \u2013 Indentation for closing delimiter line. Returns: \u2013 None.","title":"pretty_print"},{"location":"api/#HCRProbeDesign.utils.warnRestrictionSites","text":"Print a warning if restriction sites are found in a sequence. Parameters: sequence \u2013 Sequence to scan. name \u2013 Sequence label for logging. sites \u2013 Comma-delimited restriction site names. Returns: \u2013 None.","title":"warnRestrictionSites"},{"location":"api/#hcrprobedesignblast","text":"NCBI BLAST utilities for probe sequence validation.","title":"HCRProbeDesign.BLAST"},{"location":"api/#HCRProbeDesign.BLAST.blastProbes","text":"Submit a BLASTN job for the given FASTA string. Parameters: fasta_string \u2013 FASTA-formatted string containing probe sequences. species \u2013 Species key for Entrez restriction (mouse or human). verbose \u2013 Emit progress messages to stderr. Returns: \u2013 NCBIWWW result handle for subsequent parsing.","title":"blastProbes"},{"location":"api/#HCRProbeDesign.BLAST.getNHits","text":"Report the number of hits for each record in a BLAST response. Parameters: blast_handle \u2013 Handle returned by NCBIWWW.qblast. verbose \u2013 Reserved for future verbosity controls. Returns: \u2013 None.","title":"getNHits"},{"location":"api/#hcrprobedesignrepeatmask","text":"RepeatMasker web API helper utilities (deprecated).","title":"HCRProbeDesign.repeatMask"},{"location":"api/#HCRProbeDesign.repeatMask.repeatmask","text":"This function takes a sequence and returns a masked sequence with help from RepeatMasker Parameters: sequence \u2013 The sequence to be masked dnasource \u2013 vertebrate, mammal, human, rodent, mouse, rat, danio, drosophila, elegans, defaults to mouse (optional) Returns: \u2013 A masked sequence.","title":"repeatmask"},{"location":"api/#HCRProbeDesign.repeatMask.repeatmasker_local","text":"Placeholder for a local RepeatMasker wrapper. Parameters: sequence \u2013 Sequence to mask. dnasource \u2013 RepeatMasker DNA source key. Returns: \u2013 None.","title":"repeatmasker_local"},{"location":"api/#HCRProbeDesign.repeatMask.test","text":"Simple smoke test for the remote RepeatMasker flow.","title":"test"},{"location":"cli/","text":"CLI Reference \u00b6 designProbes \u00b6 Design probes for the first record in a FASTA file. designProbes targets.fa --species mouse --channel B1 --output probes.tsv --idt probes.idt Common flags: - --no-genomemask : skip Bowtie2 uniqueness checks - --index /path/to/index : override Bowtie2 index prefix - --tileSize 52 : tile size (probe length before splitting) - --minGC , --maxGC : GC content bounds - --maxProbes : maximum number of probes to emit - --calcPrice : estimate oligo synthesis cost Note: genome masking is enabled by default and requires a registered species. Use fetchMouseIndex or buildGenomeIndex first, or pass --index to point directly to a Bowtie2 index. designProbesBatch \u00b6 Design probes for every record in a FASTA file. designProbesBatch targets.fa --species mouse --channel B1 --output probes.tsv --idt probes.idt fetchMouseIndex \u00b6 Download a prebuilt mm10 Bowtie2 index and register it under the package indices directory. fetchMouseIndex buildGenomeIndex \u00b6 Build a Bowtie2 index for a new reference genome and register it in HCRconfig.yaml . buildGenomeIndex --species zebrafish --fasta /path/to/genome.fa --threads 8","title":"CLI"},{"location":"cli/#cli-reference","text":"","title":"CLI Reference"},{"location":"cli/#designprobes","text":"Design probes for the first record in a FASTA file. designProbes targets.fa --species mouse --channel B1 --output probes.tsv --idt probes.idt Common flags: - --no-genomemask : skip Bowtie2 uniqueness checks - --index /path/to/index : override Bowtie2 index prefix - --tileSize 52 : tile size (probe length before splitting) - --minGC , --maxGC : GC content bounds - --maxProbes : maximum number of probes to emit - --calcPrice : estimate oligo synthesis cost Note: genome masking is enabled by default and requires a registered species. Use fetchMouseIndex or buildGenomeIndex first, or pass --index to point directly to a Bowtie2 index.","title":"designProbes"},{"location":"cli/#designprobesbatch","text":"Design probes for every record in a FASTA file. designProbesBatch targets.fa --species mouse --channel B1 --output probes.tsv --idt probes.idt","title":"designProbesBatch"},{"location":"cli/#fetchmouseindex","text":"Download a prebuilt mm10 Bowtie2 index and register it under the package indices directory. fetchMouseIndex","title":"fetchMouseIndex"},{"location":"cli/#buildgenomeindex","text":"Build a Bowtie2 index for a new reference genome and register it in HCRconfig.yaml . buildGenomeIndex --species zebrafish --fasta /path/to/genome.fa --threads 8","title":"buildGenomeIndex"},{"location":"configuration/","text":"Configuration \u00b6 HCRProbeDesign stores reference genome index paths in HCRconfig.yaml . The file is located in the package directory and is read at runtime. Example \u00b6 species: mouse: bowtie2_index: indices/mm10/mm10 human: bowtie2_index: /path/to/hg38/index_prefix Notes \u00b6 Paths can be absolute or package-relative. buildGenomeIndex updates this file automatically. fetchMouseIndex also registers the mouse index for you. Use --config to write to a different config file when building indices.","title":"Configuration"},{"location":"configuration/#configuration","text":"HCRProbeDesign stores reference genome index paths in HCRconfig.yaml . The file is located in the package directory and is read at runtime.","title":"Configuration"},{"location":"configuration/#example","text":"species: mouse: bowtie2_index: indices/mm10/mm10 human: bowtie2_index: /path/to/hg38/index_prefix","title":"Example"},{"location":"configuration/#notes","text":"Paths can be absolute or package-relative. buildGenomeIndex updates this file automatically. fetchMouseIndex also registers the mouse index for you. Use --config to write to a different config file when building indices.","title":"Notes"},{"location":"installation/","text":"Installation \u00b6 Prerequisites \u00b6 Python >= 3.6 Bowtie2 ( bowtie2 and bowtie2-build ) for genome masking and index building If you plan to use genome masking (enabled by default), register a reference species with fetchMouseIndex or buildGenomeIndex after installing. Install from PyPI \u00b6 pip install hcrprobedesign Install from source \u00b6 git clone https://github.com/gofflab/HCRProbeDesign.git cd HCRProbeDesign # Optional: use the provided conda environment conda env create -f environment.yaml conda activate HCRProbeDesign # Install the package pip install -e . Documentation build dependencies \u00b6 If you want to build the documentation locally: pip install -r docs/requirements.txt mkdocs serve","title":"Installation"},{"location":"installation/#installation","text":"","title":"Installation"},{"location":"installation/#prerequisites","text":"Python >= 3.6 Bowtie2 ( bowtie2 and bowtie2-build ) for genome masking and index building If you plan to use genome masking (enabled by default), register a reference species with fetchMouseIndex or buildGenomeIndex after installing.","title":"Prerequisites"},{"location":"installation/#install-from-pypi","text":"pip install hcrprobedesign","title":"Install from PyPI"},{"location":"installation/#install-from-source","text":"git clone https://github.com/gofflab/HCRProbeDesign.git cd HCRProbeDesign # Optional: use the provided conda environment conda env create -f environment.yaml conda activate HCRProbeDesign # Install the package pip install -e .","title":"Install from source"},{"location":"installation/#documentation-build-dependencies","text":"If you want to build the documentation locally: pip install -r docs/requirements.txt mkdocs serve","title":"Documentation build dependencies"},{"location":"probe-design-workflow/","text":"Probe Design Workflow \u00b6 This page describes the exact probe design pipeline used by designProbes and designProbesBatch , including the order of operations, default parameters, and output formats. The steps below are listed in the same order the code applies them. Pipeline overview (ordered) \u00b6 Read FASTA record(s). designProbes uses only the first FASTA record. designProbesBatch processes every record. A FASTA header can override the channel using channel=... . Genome masking is enabled by default and requires a registered species (use fetchMouseIndex or buildGenomeIndex ) or an explicit --index . Optional repeat masking (disabled by default). If enabled, the input sequence is masked using RepeatMasker and masked bases are converted to N . Tiles containing masked bases are discarded later. Tile the target sequence (reverse-complemented). The sequence is scanned with a step size of 1 to generate 52-nt tiles by default. Each tile is reverse-complemented so probes are antisense to the target. Any tile containing N is discarded immediately. Filter homopolymer runs (C and G). Tiles are removed if they contain long runs of C's or G's beyond the allowed thresholds. Filter hairpins. Each tile is screened with primer3 for self-hairpin structures. Tiles with a predicted hairpin melting temperature >= 45 C are removed. Genome uniqueness filtering (Bowtie2). Remaining tiles are aligned to the reference genome index. Tiles with more than the allowed number of hits are removed. GC-content filtering. Tiles must fall within the allowed GC% range. Gibbs free energy filtering. Tiles with binding free energies outside the allowed range are removed. Split tiles into probe halves. Each tile is split into two 25-mers (for a 52-mer tile), dropping the two middle bases to create a short gap. Optional dTm filtering. If enabled, tiles are removed when the temperature difference between the two halves is too large. Select top N non-overlapping tiles. Tiles are ranked by how close their Gibbs free energy is to the target. Overlapping tiles are skipped to keep probes spread out. Add HCR initiators and spacers. Channel-specific initiator sequences are appended to the probe halves. Default parameters \u00b6 These are the defaults used if you do not override them on the command line. --tileSize : 52 --channel : B1 --species : mouse --minGC : 45.0 --maxGC : 55.0 --targetGC : 50.0 (not currently used in ranking or filtering) --minGibbs : -70.0 --maxGibbs : -50.0 --targetGibbs : -60.0 --dTmMax : 5.0 --dTmFilter : off --maxRunLength : 7 --maxRunMismatches : 2 --maxProbes : 20 --num-hits-allowed : 1 --no-genomemask : off (genome masking is on by default) --no-repeatmask : on (repeat masking is disabled by default) Other defaults: - Hairpin filter threshold: 45 C (not currently configurable). - Tile step size: 1 nt (not currently configurable). Thermodynamic parameters (what they mean and why they are used) \u00b6 GC% : Fraction of G/C bases in the tile. GC-rich probes bind more strongly because G-C base pairs have three hydrogen bonds. Filtering keeps probes within a moderate binding-strength window and improves uniformity. Tm (melting temperature) : Predicted temperature at which half of probe- target duplexes would melt. Reported for each full tile using primer3 . This provides a quick proxy for binding strength across candidates. dTm : The absolute difference in Tm between the two split probe halves. Large dTm values imply one half binds much more strongly than the other, which can reduce uniformity. Filtering is optional and off by default. Gibbs free energy (Gibbs FE) : Predicted free energy of RNA/DNA binding, computed at 37 C with a salt correction (0.33 M). More negative values indicate stronger binding. Filtering removes probes that are too weak or too strong, and ranking prefers probes closest to --targetGibbs . Hairpin Tm : Predicted melting temperature of a self-hairpin in the probe sequence. Strong hairpins can compete with target binding, so tiles with a hairpin Tm >= 45 C are removed. Output formats \u00b6 Primary TSV output \u00b6 designProbes and designProbesBatch write a tab-delimited table with these columns: name : Tile identifier formatted as record:start-end . probe : The reverse-complemented tile sequence. start : 1-based start position in the original target sequence. length : Tile length (default 52). P1 : Probe half with the odd initiator appended. P2 : Probe half with the even initiator appended. channel : HCR channel used (e.g., B1). GC : GC% of the tile. Tm : primer3 melting temperature of the full tile. dTm : Absolute Tm difference between the two halves. GibbsFE : Calculated Gibbs free energy of binding (kcal/mol). Example (single row): MyTarget:1-52\\tacg...\\t1\\t52\\tP1SEQ...\\tP2SEQ...\\tB1\\t50.00\\t70.12\\t1.83\\t-60.45 IDT ordering output (optional) \u00b6 If --idt is provided, an additional file is written with two columns: Name and Sequence . Each tile produces two entries: - {name}:{channel}:odd for P1 - {name}:{channel}:even for P2 Genome masking artifacts \u00b6 When genome masking is enabled, Bowtie2 writes a SAM file in the working directory named {targetName}.sam . This file lists all alignments used to compute hit counts.","title":"Probe Design Workflow"},{"location":"probe-design-workflow/#probe-design-workflow","text":"This page describes the exact probe design pipeline used by designProbes and designProbesBatch , including the order of operations, default parameters, and output formats. The steps below are listed in the same order the code applies them.","title":"Probe Design Workflow"},{"location":"probe-design-workflow/#pipeline-overview-ordered","text":"Read FASTA record(s). designProbes uses only the first FASTA record. designProbesBatch processes every record. A FASTA header can override the channel using channel=... . Genome masking is enabled by default and requires a registered species (use fetchMouseIndex or buildGenomeIndex ) or an explicit --index . Optional repeat masking (disabled by default). If enabled, the input sequence is masked using RepeatMasker and masked bases are converted to N . Tiles containing masked bases are discarded later. Tile the target sequence (reverse-complemented). The sequence is scanned with a step size of 1 to generate 52-nt tiles by default. Each tile is reverse-complemented so probes are antisense to the target. Any tile containing N is discarded immediately. Filter homopolymer runs (C and G). Tiles are removed if they contain long runs of C's or G's beyond the allowed thresholds. Filter hairpins. Each tile is screened with primer3 for self-hairpin structures. Tiles with a predicted hairpin melting temperature >= 45 C are removed. Genome uniqueness filtering (Bowtie2). Remaining tiles are aligned to the reference genome index. Tiles with more than the allowed number of hits are removed. GC-content filtering. Tiles must fall within the allowed GC% range. Gibbs free energy filtering. Tiles with binding free energies outside the allowed range are removed. Split tiles into probe halves. Each tile is split into two 25-mers (for a 52-mer tile), dropping the two middle bases to create a short gap. Optional dTm filtering. If enabled, tiles are removed when the temperature difference between the two halves is too large. Select top N non-overlapping tiles. Tiles are ranked by how close their Gibbs free energy is to the target. Overlapping tiles are skipped to keep probes spread out. Add HCR initiators and spacers. Channel-specific initiator sequences are appended to the probe halves.","title":"Pipeline overview (ordered)"},{"location":"probe-design-workflow/#default-parameters","text":"These are the defaults used if you do not override them on the command line. --tileSize : 52 --channel : B1 --species : mouse --minGC : 45.0 --maxGC : 55.0 --targetGC : 50.0 (not currently used in ranking or filtering) --minGibbs : -70.0 --maxGibbs : -50.0 --targetGibbs : -60.0 --dTmMax : 5.0 --dTmFilter : off --maxRunLength : 7 --maxRunMismatches : 2 --maxProbes : 20 --num-hits-allowed : 1 --no-genomemask : off (genome masking is on by default) --no-repeatmask : on (repeat masking is disabled by default) Other defaults: - Hairpin filter threshold: 45 C (not currently configurable). - Tile step size: 1 nt (not currently configurable).","title":"Default parameters"},{"location":"probe-design-workflow/#thermodynamic-parameters-what-they-mean-and-why-they-are-used","text":"GC% : Fraction of G/C bases in the tile. GC-rich probes bind more strongly because G-C base pairs have three hydrogen bonds. Filtering keeps probes within a moderate binding-strength window and improves uniformity. Tm (melting temperature) : Predicted temperature at which half of probe- target duplexes would melt. Reported for each full tile using primer3 . This provides a quick proxy for binding strength across candidates. dTm : The absolute difference in Tm between the two split probe halves. Large dTm values imply one half binds much more strongly than the other, which can reduce uniformity. Filtering is optional and off by default. Gibbs free energy (Gibbs FE) : Predicted free energy of RNA/DNA binding, computed at 37 C with a salt correction (0.33 M). More negative values indicate stronger binding. Filtering removes probes that are too weak or too strong, and ranking prefers probes closest to --targetGibbs . Hairpin Tm : Predicted melting temperature of a self-hairpin in the probe sequence. Strong hairpins can compete with target binding, so tiles with a hairpin Tm >= 45 C are removed.","title":"Thermodynamic parameters (what they mean and why they are used)"},{"location":"probe-design-workflow/#output-formats","text":"","title":"Output formats"},{"location":"probe-design-workflow/#primary-tsv-output","text":"designProbes and designProbesBatch write a tab-delimited table with these columns: name : Tile identifier formatted as record:start-end . probe : The reverse-complemented tile sequence. start : 1-based start position in the original target sequence. length : Tile length (default 52). P1 : Probe half with the odd initiator appended. P2 : Probe half with the even initiator appended. channel : HCR channel used (e.g., B1). GC : GC% of the tile. Tm : primer3 melting temperature of the full tile. dTm : Absolute Tm difference between the two halves. GibbsFE : Calculated Gibbs free energy of binding (kcal/mol). Example (single row): MyTarget:1-52\\tacg...\\t1\\t52\\tP1SEQ...\\tP2SEQ...\\tB1\\t50.00\\t70.12\\t1.83\\t-60.45","title":"Primary TSV output"},{"location":"probe-design-workflow/#idt-ordering-output-optional","text":"If --idt is provided, an additional file is written with two columns: Name and Sequence . Each tile produces two entries: - {name}:{channel}:odd for P1 - {name}:{channel}:even for P2","title":"IDT ordering output (optional)"},{"location":"probe-design-workflow/#genome-masking-artifacts","text":"When genome masking is enabled, Bowtie2 writes a SAM file in the working directory named {targetName}.sam . This file lists all alignments used to compute hit counts.","title":"Genome masking artifacts"},{"location":"reference-genome/","text":"Reference Genomes \u00b6 Why add a reference genome \u00b6 HCRProbeDesign can check whether candidate probes map uniquely in a genome using Bowtie2. To enable this for species or assemblies beyond the default mouse index, you need to add a Bowtie2 index and register it in HCRconfig.yaml . This lets you: - Run genome masking for non-mouse species or custom assemblies. - Keep indices organized and reusable across runs. - Avoid turning off uniqueness checks with --no-genomemask . If you do not need uniqueness checks, you can skip this entirely and use --no-genomemask . How to add a new reference genome \u00b6 1) Prepare a FASTA \u00b6 Download or generate the reference FASTA for your species or assembly. Gzipped FASTA files are supported. 2) Build and register the Bowtie2 index \u00b6 Use buildGenomeIndex to build the index and register it in HCRconfig.yaml . buildGenomeIndex --species zebrafish --fasta /path/to/genome.fa --threads 8 Notes: - --fasta is repeatable and can point to a directory; all .fa , .fasta , or .fna files (including .gz ) will be included. - Indices are written under the package indices/ directory by default. - Use --indices-dir to write indices elsewhere and --config to update a specific config file. - Use --force to overwrite an existing index or config entry. 3) Verify the configuration \u00b6 buildGenomeIndex adds an entry like this to HCRconfig.yaml : species: zebrafish: bowtie2_index: indices/zebrafish/zebrafish You can now run probe design with --species zebrafish . If needed, override the index location per run with --index /path/to/index_prefix . Prebuilt mouse index \u00b6 For mouse (mm10), you can install a prebuilt index instead of building one: fetchMouseIndex This registers the mouse entry in HCRconfig.yaml so designProbes --species mouse works immediately.","title":"Reference Genomes"},{"location":"reference-genome/#reference-genomes","text":"","title":"Reference Genomes"},{"location":"reference-genome/#why-add-a-reference-genome","text":"HCRProbeDesign can check whether candidate probes map uniquely in a genome using Bowtie2. To enable this for species or assemblies beyond the default mouse index, you need to add a Bowtie2 index and register it in HCRconfig.yaml . This lets you: - Run genome masking for non-mouse species or custom assemblies. - Keep indices organized and reusable across runs. - Avoid turning off uniqueness checks with --no-genomemask . If you do not need uniqueness checks, you can skip this entirely and use --no-genomemask .","title":"Why add a reference genome"},{"location":"reference-genome/#how-to-add-a-new-reference-genome","text":"","title":"How to add a new reference genome"},{"location":"reference-genome/#1-prepare-a-fasta","text":"Download or generate the reference FASTA for your species or assembly. Gzipped FASTA files are supported.","title":"1) Prepare a FASTA"},{"location":"reference-genome/#2-build-and-register-the-bowtie2-index","text":"Use buildGenomeIndex to build the index and register it in HCRconfig.yaml . buildGenomeIndex --species zebrafish --fasta /path/to/genome.fa --threads 8 Notes: - --fasta is repeatable and can point to a directory; all .fa , .fasta , or .fna files (including .gz ) will be included. - Indices are written under the package indices/ directory by default. - Use --indices-dir to write indices elsewhere and --config to update a specific config file. - Use --force to overwrite an existing index or config entry.","title":"2) Build and register the Bowtie2 index"},{"location":"reference-genome/#3-verify-the-configuration","text":"buildGenomeIndex adds an entry like this to HCRconfig.yaml : species: zebrafish: bowtie2_index: indices/zebrafish/zebrafish You can now run probe design with --species zebrafish . If needed, override the index location per run with --index /path/to/index_prefix .","title":"3) Verify the configuration"},{"location":"reference-genome/#prebuilt-mouse-index","text":"For mouse (mm10), you can install a prebuilt index instead of building one: fetchMouseIndex This registers the mouse entry in HCRconfig.yaml so designProbes --species mouse works immediately.","title":"Prebuilt mouse index"},{"location":"usage/","text":"Usage \u00b6 Basic workflow \u00b6 Prepare a FASTA file with your target sequence. Register a reference genome with fetchMouseIndex or buildGenomeIndex . Run designProbes (single record) or designProbesBatch (multi-record). Review the TSV output and optional IDT ordering sheet. Optionally inspect the Bowtie2 SAM file produced during genome masking. Example FASTA \u00b6 >MyTarget ACGTACGTACGTACGTACGTACGTACGTACGT Single-record probe design \u00b6 Before running, register a species or provide --index (or skip genome masking with --no-genomemask ). designProbes targets.fa --species mouse --channel B1 --output probes.tsv --idt probes.idt Batch probe design \u00b6 designProbesBatch targets.fa --species mouse --channel B1 --output probes.tsv --idt probes.idt Override channel per record \u00b6 Add channel= to the FASTA header: >MyTarget channel=B2 ACGTACGTACGTACGTACGTACGT","title":"Usage"},{"location":"usage/#usage","text":"","title":"Usage"},{"location":"usage/#basic-workflow","text":"Prepare a FASTA file with your target sequence. Register a reference genome with fetchMouseIndex or buildGenomeIndex . Run designProbes (single record) or designProbesBatch (multi-record). Review the TSV output and optional IDT ordering sheet. Optionally inspect the Bowtie2 SAM file produced during genome masking.","title":"Basic workflow"},{"location":"usage/#example-fasta","text":">MyTarget ACGTACGTACGTACGTACGTACGTACGTACGT","title":"Example FASTA"},{"location":"usage/#single-record-probe-design","text":"Before running, register a species or provide --index (or skip genome masking with --no-genomemask ). designProbes targets.fa --species mouse --channel B1 --output probes.tsv --idt probes.idt","title":"Single-record probe design"},{"location":"usage/#batch-probe-design","text":"designProbesBatch targets.fa --species mouse --channel B1 --output probes.tsv --idt probes.idt","title":"Batch probe design"},{"location":"usage/#override-channel-per-record","text":"Add channel= to the FASTA header: >MyTarget channel=B2 ACGTACGTACGTACGTACGTACGT","title":"Override channel per record"}]}